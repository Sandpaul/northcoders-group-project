DROP CREATED AT AND LAST UPDATED:

dim_design, dim_payment_type, dim_location?, dim_transaction


----------------------------------------------------------

counterparty:
-------------
counterparty_id
counterparty_legal_name
legal_address_id
commercial_contact
delivery_contact
created_at
last_updated

dim_counterparty:
-----------------
counterparty_id
counterparty_legal_name
counterparty_legal_address_line_1
counterparty_legal_address_line_2
counterparty_legal_district
counterparty_legal_city
counterparty_legal_postal_code
counterparty_legal_country
counterparty_legal_phone_number

join address on address_id = legal_address_id
split address
drop created_at and last_updated

address:
--------
address_id
address_line_1
address_line_2
district
city
postal_code
country
phone
created_at
last_updated

dim_location:
-------------
location_id
address_line_1
address_line_2
district
city
postal_code
country
phone

rename address_id to location_id
drop created_at and last_updated


design:
-------
design_id
created_at
last_updated
desgin_name
file_location
file_name

dim_design:
-----------
design_id
design_name
file_location
file_name

drop created_at and last_updated

payment_type:
-------------
payment_type_id
payment_type_name
created_at
last_updated

dim_payment_type:
-----------------
payment_type_id
payment_type_name

drop created_at and last_updated

staff:
------
staff_id
first_name
last_name
department_id
email_address
created_at
last_updated

department:
-----------
department_id
department_name
location
manager
created_at
last_updated

dim_staff:
----------
staff_id
first_name
last_name
department_name
location
email_address

join staff with department on department_id
drop department id
drop created_at and last_updated
drop manager

transaction:
------------
transaction_id
transaction_type
sales_order_id
purchase_order_id
created_at
last_updated

dim_transaction:
----------------
transaction_id
transaction_type
sales_order_id
purchase_order_id

drop created_at and last_updated

payment:
--------
payment_id
created_at
last_updated
transaction_id
counterparty_id
payment_amount
currency_id
payment_type_id
paid 
payment_date
company_ac_number
counterparty_ac_number

fact_payment:
-------------
payment_id
created_date
created_time
last_updated_date
last_updated_time
transaction_id
counterparty_id
payment_amount
currency_id
payment_type_id
paid
payment_date

split created at into date and time
split last_updated into date and time
drop company_ac_number and counterparty_ac_number

purchase_order:
---------------
purchase_order_id
created_at
last_updated
staff_id
counterparty_id
item_code
item_quantity
item_unit_price
currency_id
agreed_delivery_date
agreed_payment_date
agreed_delivery_location_id

fact_purchase_order:
purchase_order_id
created_date
created_time
last_updated_date
last_updated_time
staff_id
counterparty_id
item_code
item_quantity
item_unit_price
currency_id
agreed_delivery_date
agreed_payment_date
agreed_delivery_location_id

split created_at into created_date and created_time
split last_updated into last_updated_date and last_updated_time

sales_order:
------------
sales_order_id
created_at
last_updated
design_id
staff_id
counterparty_id
units_sold
unit_price
currency_id
agreed_delivery_date
agreed_payment_date
agreed_delivery_location_id

fact_sales_order:
-----------------
sales_order_id
created_date
created_time
last_updated_date
last_updated_time
sales_staff_id
counterparty_id
units_sold
unit_price
currency_id
design_id
agreed_payment_date
agreed_delivery_date
agreed_delivery_location_id

split created_at into created_date and created_time
split last_updated into last_updated_date and last_updated_time
rename staff_id to sales_staff_id

